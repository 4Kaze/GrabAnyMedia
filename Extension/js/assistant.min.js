!function(){"use strict";var t="display:none!important;",e="display:block!important;",n=document.location.href,o=100,r=chrome.runtime.getURL("img/icon.48.png"),i=chrome.runtime.getURL("img/icon.48.red.png"),a={save:chrome.i18n.getMessage("save"),watch_later:chrome.i18n.getMessage("watch_later"),analize:chrome.i18n.getMessage("analize"),download:chrome.i18n.getMessage("download"),loading:chrome.i18n.getMessage("loading")},c="x-gam-assistant",u="x-gam-assistant-action",l=function(t){var e=function(t){try{t.parentNode.removeChild(t)}catch(e){}};t=t||document.querySelectorAll("["+c+"='toremove']"),NodeList.prototype.isPrototypeOf(t)?t.forEach(function(t){e(t)}):e(t)},s=function(t){var e=t.src||"";if(!e||e.length<1){var n=t.querySelector(["source[type='video/mp4']","source[type='video/webm']","source[type='video/flv']"].join(","));n&&n.src&&(e=n.src)}return e},p=function(n){var o=function(n){var o=n.getAttribute("style")||"";o=o.replace(t,"").replace(e,""),n.setAttribute("style",o+e)};NodeList.prototype.isPrototypeOf(n)?n.forEach(function(t){o(t)}):o(n)},m=function(n){var o=function(n){var o=n.getAttribute("style")||"";o=o.replace(t,"").replace(e,""),n.setAttribute("style",o+t)};NodeList.prototype.isPrototypeOf(n)?n.forEach(function(t){o(t)}):o(n)},d=function(e){var n=function(e){var n=e.getAttribute("style")||"";n.indexOf(t)<0?m(e):p(e)};NodeList.prototype.isPrototypeOf(e)?e.forEach(function(t){n(t)}):n(e)},f=function(t){return null===t.offsetParent},g=function(t){var e=t.getBoundingClientRect().top,n=t.getBoundingClientRect().bottom;return e>=0&&n<=window.innerHeight},v=function(t,e,n){return t?(chrome.runtime.sendMessage({exe:"newTab",url:e}),!1):void chrome.runtime.sendMessage({exe:"download",srcvideo:e,title:n})},y=function(){chrome.runtime.sendMessage({exe:"openConsole"})},h=function(t,e){if(!t||!e)return!1;var n=t.getBoundingClientRect(),o={top:n.top+window.pageYOffset,left:n.left+window.pageXOffset};e.setAttribute("style","top:"+o.top+"px!important;left:"+o.left+"px!important;")},A=function(t,e,n){"function"!=typeof e&&(e=function(){}),n=!!n;var o=new MutationObserver(function(t){t.forEach(function(t){e(t)})}),r={attributes:n,childList:!0,subtree:!0};o.observe(t,r)},b=function(t,e,n){try{if(e.addEventListener)e.addEventListener(t,n,!1);else{if(!e.attachEvent)return!1;{e.attachEvent("on"+t,n)}}return!0}catch(o){return!1}},x=function(n){var o=n.parentNode;if(!o||!document.body||f(n))return!1;var g=function(){E.setAttribute("src",r);var t=S.querySelectorAll("["+c+"='normal']")||[],e=S.querySelectorAll("["+c+"='loading']")||[];l(),t.forEach(function(t){p(t)}),e.forEach(function(t){m(t)})},x=function(){E.setAttribute("src",i);var t=S.querySelectorAll("["+c+"='normal']")||[],e=S.querySelectorAll("["+c+"='loading']")||[];l(),t.forEach(function(t){m(t)}),e.forEach(function(t){p(t)})},w=function(){E.setAttribute("src",r);var t=S.querySelectorAll("["+c+"='normal']")||[],e=S.querySelectorAll("["+c+"='loading']")||[];t.forEach(function(t){m(t)}),e.forEach(function(t){m(t)})},E=document.createElement("img"),S=document.createElement("div"),q=document.createElement("div"),M=Date.now();if(document.querySelector("video["+c+"='"+M+"']")||!o)return!1;n.setAttribute(c,M),q.setAttribute(c,"container"+M),q.setAttribute("style",e),E.setAttribute(c,"assistant"),E.setAttribute("src",r),E.setAttribute("style",t),S.setAttribute(c,"menu"),S.setAttribute("style",t),S.innerHTML=["<p "+c+"='loading' style='margin:0px!important;"+t+"'>"+a.loading+"</p>","<p "+c+"='normal' "+u+"='analize' style='margin:0px!important;margin-top:5px!important;'>"+a.analize+"</p>","<hr "+c+"='normal' style='margin:0px!important;margin-top:5px!important;'>","<p "+c+"='normal' "+u+"='download' style='margin:0px!important;margin-top:5px!important;'>"+a.download+"</p>"].join(" "),b("click",E,function(t){return n.pause(),d(S),t.stopPropagation(),!1}),b("mouseover",E,function(t){return n.pause(),p(S),t.stopPropagation(),!1}),b("mouseover",q,function(t){f(n)||p(E),t.stopPropagation()}),b("mouseleave",q,function(t){f(S)&&m(E),t.stopPropagation()});var O=S.querySelectorAll("p["+c+"='normal']")||[];O.forEach(function(t){b("click",t,function(t){if(t.stopPropagation(),x(),n.pause(),"download"==t.target.getAttribute(u)){var o=s(n);window.GAMMODULE?window.GAMMODULE.getLinks(null,function(t){if("string"==typeof t)chrome.runtime.sendMessage({exe:"newTab",url:t}),g();else if(!t||t.length<1)alert(chrome.i18n.getMessage("to_analize")),g();else{w();var n=document.createElement("p");n.setAttribute(c,"toremove"),n.setAttribute("style","margin:0px!important;font-size:14px!important;"+e),n.textContent="Â«",b("click",n,function(t){return g(),t.stopPropagation(),!1}),S.append(n),t.forEach(function(t){var n=document.createElement("p");n.setAttribute(c,"toremove"),n.setAttribute("style","margin:0px!important;margin-top:10px!important;"+e),n.textContent=t.quality,b("click",n,function(e){e.stopPropagation(),x();var n=".mp4";return t.type.indexOf("/3gpp;")>-1?n=".3gpp":t.type.indexOf("/webm;")>-1?n=".webm":t.type.indexOf("/flv;")>-1?n=".flv":t.type.indexOf("/avi;")>-1&&(n=".avi"),setTimeout(function(){var o=!t.title||t.title.length<1?null:t.title.replace(/[^\w]/gi,"_")+n;v(e.ctrlKey,t.url,o)},500),!1}),S.append(n)})}},o,t.ctrlKey):o&&o.length>0?v(t.ctrlKey,o):(alert(chrome.i18n.getMessage("to_play")),g())}else"analize"==t.target.getAttribute(u)?y():g();return!1})});var L=S.querySelectorAll("p["+c+"='loading']")||[];L.forEach(function(t){b("click",t,function(t){return n.pause(),t.stopPropagation(),!1})}),q.prepend(S),q.prepend(E),document.body.append(q),A(n,function(){h(n.parentNode,q)},!0),h(n.parentNode,q)},w=function(t){"undefined"==typeof t&&(t=o),t=parseInt(t)||0,setTimeout(function(){var t=document.querySelectorAll("video:not(["+c+"])")||[];t.forEach(function(t){x(t)})},t)},E=function(t){"undefined"==typeof t&&(t=o),t=parseInt(t)||0,setTimeout(function(){var t=document.querySelectorAll("["+c+"^='container']")||[];t.forEach(function(t){var e=parseInt(t.getAttribute(c).replace("container",""));if(!e||1>e)return!1;var n=document.querySelector("["+c+"='"+e+"']");if(!n)return l(t);var o=t.querySelector("["+c+"='assistant']"),r=t.querySelector("["+c+"='menu']");g(t)||(m(r),m(o)),h(n.parentNode,t),n.onpause=function(){p(o)},n.onplay=function(){m(r),m(o)}})},t)},S=function(){var t=document.querySelectorAll("["+c+"='normal']")||[],e=document.querySelectorAll("["+c+"='loading']")||[],n=document.querySelectorAll("img["+c+"='assistant']")||[],o=document.querySelectorAll("["+c+"='menu']")||[];l(),p(t),m(e),m(o),n.forEach(function(t){t.setAttribute("src",r)})},q=function(){var t=document.querySelectorAll("["+c+"^='container']");l(t);var e=document.querySelectorAll("["+c+"]");e.forEach(function(t){t.removeAttribute(c)})},M=function(){A(document.body,function(){n!=document.location.href&&(n=document.location.href,q()),w(),E(1)},!1),w()},O={allToNormal:function(t){S(),t.mex&&alert(t.mex)}};b("resize",window,function(){var t=document.querySelectorAll("video["+c+"]")||[];t.forEach(function(t){var e=t.getAttribute(c),n=document.querySelector("["+c+"='container"+e+"']");e&&e.length>0&&n&&(m(n.childNodes),h(t.parentNode,n))})}),chrome.runtime.onMessage.addListener(function(t,e,n){try{O[t.cmd](t,e,n)}catch(o){}}),M()}();
//# sourceMappingURL=assistant.min.js.map